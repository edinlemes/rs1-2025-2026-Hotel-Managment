
<div class="min-h-screen bg-[var(--color-surface)]">


  <main class="flex justify-center bg-[var(--color-surface)] px-3 py-8 sm:px-4 sm:py-12">
    <div class="w-full max-w-2xl overflow-hidden rounded-[var(--radius-md)] border border-[var(--color-border)] bg-white shadow-[var(--shadow-card)]">
      <div class="flex border-b border-[var(--color-border)]">
        <button
          type="button"
          class="flex-1 border-b-2 border-transparent px-4 py-3 text-sm font-semibold text-[var(--color-muted)] transition hover:text-[var(--color-brand)] sm:text-base"
          [ngClass]="activeTab === 'login' ? 'border-[var(--color-brand)] text-[var(--color-brand)]' : ''"
          (click)="setTab('login')"
        >
          Login
        </button>
        <button
          type="button"
          class="flex-1 border-b-2 border-transparent px-4 py-3 text-sm font-semibold text-[var(--color-muted)] transition hover:text-[var(--color-brand)] sm:text-base"
          [ngClass]="activeTab === 'register' ? 'border-[var(--color-brand)] text-[var(--color-brand)]' : ''"
          (click)="setTab('register')"
        >
          Registracija
        </button>
      </div>

      <form *ngIf="form" class="space-y-4 p-5 sm:p-6" [formGroup]="form" (ngSubmit)="onSubmit()">
        <ng-container *ngFor="let field of currentFields">
          <ng-container [ngSwitch]="field.type">
            <div *ngSwitchCase="'text'" class="space-y-1">
              <label [for]="field.key" class="block text-sm font-medium text-[var(--color-link)]">
                {{ field.label }}
              </label>
              <input
                [id]="field.key"
                type="text"
                [formControlName]="field.key"
                [class.border-[var(--color-danger)]]="isFieldInvalid(field.key)"
                class="w-full rounded-[var(--radius-sm)] border border-[var(--color-border)] bg-white px-3 py-2 text-sm text-[var(--color-text)] transition focus:border-[var(--color-brand)] focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)]/20"
              />
              <p *ngIf="isFieldInvalid(field.key)" class="text-xs text-[var(--color-danger)] mt-1">
                {{ getErrorMessage(field.key) }}
              </p>
            </div>

            <div *ngSwitchCase="'email'" class="space-y-1">
              <label [for]="field.key" class="block text-sm font-medium text-[var(--color-link)]">
                {{ field.label }}
              </label>
              <input
                [id]="field.key"
                type="email"
                autocomplete="email"
                [formControlName]="field.key"
                [class.border-[var(--color-danger)]]="isFieldInvalid(field.key)"
                class="w-full rounded-[var(--radius-sm)] border border-[var(--color-border)] bg-white px-3 py-2 text-sm text-[var(--color-text)] transition focus:border-[var(--color-brand)] focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)]/20"
              />
              <p *ngIf="isFieldInvalid(field.key)" class="text-xs text-[var(--color-danger)] mt-1">
                {{ getErrorMessage(field.key) }}
              </p>
            </div>

            <div *ngSwitchCase="'password'" class="space-y-1">
              <label [for]="field.key" class="block text-sm font-medium text-[var(--color-link)]">
                {{ field.label }}
              </label>
              <input
                [id]="field.key"
                type="password"
                autocomplete="current-password"
                [formControlName]="field.key"
                [class.border-[var(--color-danger)]]="isFieldInvalid(field.key)"
                class="w-full rounded-[var(--radius-sm)] border border-[var(--color-border)] bg-white px-3 py-2 text-sm text-[var(--color-text)] transition focus:border-[var(--color-brand)] focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)]/20"
              />
              <p *ngIf="isFieldInvalid(field.key)" class="text-xs text-[var(--color-danger)] mt-1">
                {{ getErrorMessage(field.key) }}
              </p>
            </div>

            <div *ngSwitchCase="'select'" class="space-y-1">
              <label [for]="field.key" class="block text-sm font-medium text-[var(--color-link)]">
                {{ field.label }}
              </label>
              <select
                [id]="field.key"
                [formControlName]="field.key"
                [class.border-[var(--color-danger)]]="isFieldInvalid(field.key)"
                class="w-full rounded-[var(--radius-sm)] border border-[var(--color-border)] bg-white px-3 py-2 text-sm text-[var(--color-text)] transition focus:border-[var(--color-brand)] focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)]/20"
              >
                <option value="">{{ field.placeholder || 'Odaberi...' }}</option>
                <ng-container *ngIf="field.options?.length">
                  <option *ngFor="let opt of field.options" [value]="opt.value">{{ opt.label }}</option>
                </ng-container>
              </select>
              <p *ngIf="isFieldInvalid(field.key)" class="text-xs text-[var(--color-danger)] mt-1">
                {{ getErrorMessage(field.key) }}
              </p>
            </div>

            <div *ngSwitchDefault>
              <p class="text-sm text-[var(--color-danger)]">Nepodr≈æan tip: {{ field.type }}</p>
            </div>
          </ng-container>
        </ng-container>

        <div *ngIf="successMsg" class="rounded-[var(--radius-sm)] border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-700">
          {{ successMsg }}
        </div>

        <div *ngIf="errorMsg" class="rounded-[var(--radius-sm)] border border-[var(--color-danger-border)] bg-[var(--color-danger-bg)] px-3 py-2 text-sm text-[var(--color-danger)]">
          {{ errorMsg }}
        </div>

        <button
          type="submit"
          [disabled]="isLoading"
          class="w-full rounded-[var(--radius-sm)] bg-[var(--color-brand)] px-4 py-3 text-sm font-semibold text-white shadow-sm transition hover:brightness-110 disabled:cursor-not-allowed disabled:opacity-60 active:translate-y-px"
        >
          {{ isLoading ? (activeTab === 'login' ? 'Prijava...' : 'Slanje...') : (activeTab === 'login' ? 'Login' : 'Registruj se') }}
        </button>
      </form>
    </div>
  </main>
</div>
